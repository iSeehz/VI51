/**
 * 
 */
package fr.utbm.vi51.^agent

import fr.utbm.vi51.^event.AreYouAwoken
import fr.utbm.vi51.^event.StopSimulation
import fr.utbm.vi51.gui.FrameProject
import fr.utbm.vi51.model.EnvironmentModel
import io.sarl.core.AgentTask
import io.sarl.core.DefaultContextInteractions
import io.sarl.core.Initialize
import io.sarl.core.Lifecycle
import io.sarl.core.Logging
import io.sarl.core.Schedules
import io.sarl.lang.core.Address
import java.util.List
import fr.utbm.vi51.^event.IamAwoken

/**
 * @author tiboty
 *
 */
agent EnvironmentAgent {
	uses DefaultContextInteractions, Logging, Lifecycle, Schedules
	var initAgent : AgentTask
	var listOfGUID : List<Address>
	var environment:EnvironmentModel
	var gui:FrameProject
	
	
	on Initialize{

		environment = new EnvironmentModel()
		gui = new FrameProject(environment)
		
		spawn(typeof(LemmingAgent))
		
		
		task = initAgent("presentation")
		
		initAgent.every(1000) [
			emit(new AreYouAwoken)
		]
		
	}
	
	on IamAwoken{
		
		initAgent.cancel
		listOfGUID.add(occurrence.source)
	}
	
	on StopSimulation {
		killMe
	}
}